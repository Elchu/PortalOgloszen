@model PagedList.IPagedList<Repozytory.Models.Ogloszenie>
@using Microsoft.AspNet.Identity
@using PagedList.Mvc

@{
    ViewBag.Title = "Lista ogłoszeń";
    ViewBag.Opis = "Opis do 160 znaków";
    ViewBag.SlowaKluczowe = "Słowa kluczowe, ogłoszenie, usługa";
}

@section styles {
    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/PagedList.css")">
}

<h2>Lista ogłoszeń</h2>

<div class="row">
    <div class="col-sm-6">
        @if (User.Identity.IsAuthenticated)
        {
            <p>
                <a href="@Url.Action("Create", "Ogloszenie", null)" alt="Dodaj ogłoszenie" title="Dodaj ogłoszenie" class="btn btn-success"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Dodaj ogłoszenie</a>
            </p>    
        }        
    </div>
    <div class="col-sm-6 text-right">
        @if (ViewBag.DataSortowaniaRosnaco == "DataDodaniaAsc")
        {
            <p>
                <span class="glyphicon glyphicon-chevron-down">Data malejąco</span> 
                <span> | </span>
                @Html.ActionLink("Data rosnąco", "Index", new { orderSort = "DataDodaniaAsc" })    
            </p>
        }
        else if(ViewBag.DataSortowaniaRosnaco == "DataDodaniaDesc")
        {
            <p>
                @Html.ActionLink("Data malejąco", "Index", new { orderSort = "DataDodaniaDesc" })
                <span> | </span>
                <span class="glyphicon glyphicon-chevron-up">Data rosnąco</span>    
            </p>
        }

    </div>
</div>


<div class="row">
    

@foreach (var item in Model)
{
    <div class="col-sm-8 col-sm-offset-2">
        <div class="panel panel-white post panel-shadow">
            <div class="post-heading">
                <div class="pull-left image">
                    <img src="@Url.Content("/Content/Images/user.jpg")" class="img-circle avatar" alt="user profile image">
                </div>
                <div class="pull-left meta">
                    <div class="title h5">
                        <a href="#"><b>@item.Uzytkownik.UserName</b></a>
                    </div>
                    <h6 class="text-muted time">@item.DataDodania</h6>
                </div>
                <div class="pull-right meta">
                    <div class="title h5">
                        
                        @if (User.Identity.IsAuthenticated && (User.IsInRole("Admin") || User.IsInRole("Pracownik") || User.Identity.GetUserId() == item.UzytkownikId))
                        {
                            <a href="@Url.Action("Edit", "Ogloszenie", new {id = item.OgloszenieId})" alt="Edytuj" title="Edytuj" class="btn btn-info btn-xs"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>

                            if (User.IsInRole("Admin"))
                            {
                                <a href="@Url.Action("Delete", "Ogloszenie", new {id = item.OgloszenieId})" alt="Usuń" title="Usuń" class="btn btn-danger btn-xs"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a>        
                            }
                        }

                        <a href="@Url.Action("Details", "Ogloszenie", new {id = item.OgloszenieId})" alt="Szczegóły" title="Szczegóły" class="btn btn-warning btn-xs"><span class="glyphicon glyphicon-zoom-in" aria-hidden="true"></span></a>
                    </div>
                </div>
            </div>
            <div class="post-description">
                <h4>@item.Tytul</h4>
                <p>@item.Tresc</p>
                <div class="stats">
                    <a href="#" class="btn btn-default stat-item">
                        <i class="fa fa-thumbs-up icon"></i>2
                    </a>
                    <a href="#" class="btn btn-default stat-item">
                        <i class="fa fa-thumbs-down icon"></i>12
                    </a>
                </div>
            </div>
        </div>
    </div>
}

</div>@*row*@

<div class="row text-center">
    <br />
    Strona @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) z @Model.PageCount @Html.PagedListPager(Model, page => Url.Action("Index", new { page, orderSort = ViewBag.CurrentSort }))
</div>
    

